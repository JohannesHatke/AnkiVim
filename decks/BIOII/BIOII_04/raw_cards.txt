ProbCons and Probalign  	[latex]ProbCons + Probalign:\begin{itemize}    \item Idea: similar to T-Coffee, but based on stochastic model\begin{enumerate}    \item be fast using progressive alignment    \item use triplets to improve alignment    \item consider also sub-optimal alignment    \item hence: probabilistic model for alignment needed\end{enumerate}\item ProbCons: Pair-HMM\item ProbAlign: partition function  approach\end{itemize}[/latex]
Probabilistic Models for Alignment (Pair-HMM vs ProbCons)  	[latex]1. Pair-HMM: old approach for aligning sequences\\[/latex]TODO: INSERT IMAGES SLIDE 3 SLIDESET 04[latex]2. Probabiliy Space and Estimators\\\begin{itemize}    \item given $2$ sequences, optimal alignment is maximum likelihood estimator    \item implicit assumption maximum likelihood: maximum also for clusters ofneighbors\end{itemize}Assumption migh be violated, example:[/latex]TODO: INSERT IMAGE WITH TEXT BESIDE AND BENEATH SLIDE 4 SLIDESET 04
Probcons Step 0: Define Neighborship  	[latex]\begin{itemize}    \item idea: how much oerlap has alignment with others: more overlap $=$better alignment    \item Define accuracy $acc$ of alignment $a^*$ wrt. other alignment $a$ as numberof common aligned pairs divided by length of shorter sequence\end{itemize}\begin{align*}acc(a, a^*) &= \frac{1}{min(|x|, |y|)}(a \cap a^*)\\            &= \frac{1}{min(|x|, |y|)} \sum \limits_{x_i \sim y_j \in a^*}\mathbf{1}\{x_i \sim y_j \in a\}\end{align*}where $x_i \sim y_j \in a$ is true iff $x_i, y_j$ match in alignment $a$[/latex]
 Probcons Step 1: Reliability of alignment edge 	[latex]\begin{itemize}    \item for every pair of sequences $x,y$ compute probability that letters$x_i, y_j$ match in $a^*$, an alignment of $x,y$ generated by the model:\begin{align*}P(x_i \sim y_j |x,y) &= Pr[x_i \sim y_j \text{ in some } a|x,y]\\                     &=\sum \limits_{\text{alignment } a \text{ with } x_i \simy_j \in a} Pr[a|x,y]                    &= \sum \sum \limits_{\text{alignment } a \text{ with } x_i \simy_j \in a} \mathbf{1}\{x_i \sim y_j \in a\} Pr[a|x,y]\end{align*}\item Computed using forward/backward algorithms for computing posteriorprobabilities in pair-HMM\end{itemize}[/latex]
ProbCons Step 2: Computation of Expected accuracies 	[latex]\begin{itemize}    \item expected accuracy: consider all other $a$ according to distribution\begin{align*}E_{Pr[a|x,y]}(acc(a, a^*)) &= \sum \limits_a Pr[a|x,y] acc(a, a^*)\\                           &= \frac{1}{min(|x|, |y|)} \sum \limits_a Pr[a|x,y]\sum \limits_{x_i \sim y_j \in a^*} \mathbf{1}\{x_i \sim y_j \in a\}\\                           &= \frac{1}{min(|x|, |y|)} \sum \limits_{x_i \simy_j \in a^*} P(x_i \sim y_j | x,y)\end{align*}\item maximum expected accuracy (MEA) alignment:\begin{equation*}E(x,y) = arg\max \limits_{a^*} E_{Pr[a|x,y]}(acc(a, a^*))\end{equation*}\item scores complete alignment just by sum of match similarities\item hence: $E(x,y)$ by Needleman Wunsch with $P(x_i \sim y_j|x,y)$ matchsimilarities and $0$ gap penalty\end{itemize}[/latex]
Probcons Step 4: Computation of Guide Tree 	[latex]\begin{enumerate}    \item Construct tree by hierarchical clustering    \item Use MEA-score $E(x,y)$ for similarity of sequences $x,y$    \item Define similarity of two clusters by weighted average of pairwisesimilarities between sequences of clusters\end{enumerate}[/latex]
Probcons Step 5+6: Computation of Guide Tree + Iterative Alignment 	[latex]progressive alignment:\begin{enumerate}    \item sum-of-pairs scores    \item $P(x_i \sim y_j|x,y)$ as similarity for match $x_i \sim y_j$    \item gap cost $0$\end{enumerate}iterative alignment:\begin{enumerate}    \item re-align to repair mistakes    \item randomly split clusters into $2$ groups + re-align    \item repeat (e.g. $100$ times)\end{enumerate}[/latex]
Probcons step 3: Probabilistic Consistency Transformation  	TODO: INSERT IMAGES SLIDE 8 + 9 from SLIDESET 04
Probcons Step 3 (Untractable Alternative): Correct consistency transformation  	TODO: INSERT IMAGE + TEXT FROM SLIDE 11 SLIDESET 04
