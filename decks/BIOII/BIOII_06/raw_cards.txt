Formally: Maximum Weight Trace Problem  	[latex]\begin{itemize}    \item Alignment: $A=(A_{ij})_{i \in [1,n], j \in [1, K]}$ for $n$sequencces and alignment length $K$    \item MSA optimization: sum-of-pairs score $D$ based on pairwise score $w_p$    \item Similarity of alignment (Cost):\begin{equation*}D(A) = \sum \limits_{i < i'} \sum \limits_{1 \leq j \leq K} w_p(A_{ij}, A_{i'j}\end{equation*}    \item equivalent to $D(A) =  \sum \limits_{1 \leq j \leq K}\sum \limits_{i <i'}w_p(A_{ij}, A_{i'j}$\\ $\Rightarrow$ special case of sum-of-pairs sccorewith cost for column j:\begin{equation*}w(a_1, \dots, a_n) = \sum \limits_{i < i'}w_p(A_{ij},A_{i'j}\end{equation*}    \item transformable into problem on graphs\end{itemize}[/latex]
Maximum Weight Trace: Graph  	[latex]\begin{enumerate}    \item consider n-partite graph $G=(V, E)$    \item nodes $=$ letters of strings to align: $S_{i} = s_{i1} \dotss_{in_{i}}$:\begin{equation*}V = V_1 \dots V_n\end{equation*}where $V_i = \{s_{i1} \dots s_{in_{i}}$    \item edges: for every $v \in V_i, v' \in V_j$ there is edge $e = (v, v')          \in E$ iff $i \neq j$         and with every edge $e$ there is a positive weight $w(e)$ associated.    \item $G$ called complete alignment graph for sequences $S_1, \dots S_n$    and it represents all possible multiple sequence alignments for these          sequences    \item an alignment graph $G'$ is a subgraph of complete alignment graph\end{enumerate}[/latex]
Alignment graphs: realizing an edge  	[latex]Alignment $A$ for sequences $S_1, \dots, S_n$ realizes edge $e = (s_{ij},s_{i'j'} \in E$ of alignment graph $G=(V,E)$ if $j$th character of $S_i$ and$j$th caracter of $S_{i'}$ are aligned in $A$.[/latex]
(Complete) Maximum Weight Trace (on graphs) 	[latex]Let $S_1, \dots, S_n$ be sequences, $G=(V,E)$ be the complete alignmentgraph, $w$ be weight function. The complete maximum-weight trace problem is tofind trace $T \subset E$ with maximal weight $\sum \limits_{e \in T} w(e)$. This problem is defined analogously for an (incomplete) alignment graph $G$.[/latex]
Maximum Weight Trace: Non-Trace Subsets  	[latex]Problem: Not every subset of edges of the (complete) alignment graph is a trace.[/latex]TODO:INSERT IMAGE FROM SLIDESET 6 SLIDE 6
Extended Alignment Graphs: Motivation 	[latex]Not every edge-subset of a (complete) alignment graph is a trace (e.g. crossingedges are not).\\ \\Idea: extend alignment graphs by strict partial orders over the nodes to avoidedge crossings. [/latex]
Extended Alignment Graphs: Strict partial orders  	[latex]Given: sequences $S_1, \dots S_n$ with $S_i = s_{i1} \dots s_{in_{i}}$\\ \\Partial orders over nodes:\begin{enumerate}\item extended alignment graph: $G=(V, E, \prec)$ where $(V,E)$ is an alignmentgraph and $\prec$ is partial order:\begin{equation*}\prec = \{(s_{ij}, s_{ij+1}) | i \in [1,n] \wedge j \in [1, n_i]\}\end{equation*}\item $\prec^*$ is transitive closure of $\prec$ and strict partial order ofnodes $V$\end{enumerate}Extending to connected components:\begin{enumerate}    \item connected component of $(V,E)$ is $\subseteq$-maximal set $V'\subseteq V$ s.t. for all vertices $v,v' \in V'$ there is a path of edgesconnecting $v$ and $v'$    \item For any two subsets $X, Y \subseteq V$, let:\begin{equation*}X \triangleleft Y \text{ iff } \exists v \in X \exists v' \in Y: v \prec v'\end{equation*}    \item Let $\triangleleft^*$ be the transitive closure (strict partial orderof (connected) components)\end{enumerate}[/latex]
Extended alignment graphs: Theorem of Kececioglu  	[latex]Let $S_1, \dots, S_n$ be sequences and $G=(V, E, \prec)$ the extended alignmentgraph. Then a subset $T \subseteq E$ is a trace if and only if$\triangleleft^*$ is a strict partial order on the connected components of $G'= (V, T)$[/latex]
Formally: Maximum Weight Trace Problem  	[latex]\begin{itemize}    \item Alignment: $A=(A_{ij})_{i \in [1, n], j \in [1, K]}$ for $n$sequences and alignment length $K$    \item MSA Optimization: sum-of-pairs score $D$ based on pairwise score $w_p$    \item Cost(Similarity of alignment):\begin{equation*}D(A) = \sum \limits_{i < i'}\sum \limits_{j \in [1, K]} w_p(A_{ij}, A_{i'j})\end{equation*}\item equivalent to $D(A) = \sum \limits_{j \in [1, K]} \sum \limits_{i < i'}w_p(A_{ij}, A_{i'j}$\item special case of sum-of-pairs score with cost for column $j: w(a_1, \dots,a_n) = \sum  \limits_{i < i'} w_p(A_{ij}, A_{i'j}$\item $\Rightarrow$ now transform problem into graph problem\end{itemize}[/latex]
Maximum Weight Trace: Graph  	[latex]\begin{enumerate}    \item nodes $=$ letters of strings $S_i = s_{i1} \dots s_{i n_i}$:\begin{equation*}V = V_1 \uplus \dots \uplus V_n\end{equation*}where $V_i = \{s_{i1} \dots s_{i n_i}$    \item Edges: for every $v \in V_i, v' \in V_j: e = (v,v') \in E$ iff $i          \neq j$ (edges between all letters in different strings)    \item every edge $e \in E$ has positive weight $w(e)$    \item Then: $G=(V,E)$ is complete alignment graph for sequences $S_1,\dots S_n$ - represents all possible multiple sequence alignments    \item An alignment graph $G'$ is a subgraph of the complete alignment graph\end{enumerate}[/latex]
Definition: "Alignment realizing edge of Alignment Graph" 	[latex]An alignment $A$ for sequences $S_1, \dots, S_n$ realizes edge $e = (s_{ij},s_{i'j'} \in E$ of alignment graph $G=(V,E)$ for sequences $S_1, \dots, S_n$ if $j$th character of $S_i$ and $j'$th character of $S_{i'}$are aligned in $A$.[/latex]
Problem Definition: (Complete) Maximum-Weight Trace  	[latex]\begin{itemize}    \item trace of $A$ = set of all edges realized by $A$    \item a set $T \subset E$ of edges is called trace if it is trace of some        alignment    \item given weight function $w$: weight of trace $T$ is $\sum \limits_{e\in T}w(e)$\end{itemize}(Complete) Maximum-Weight Trace:\\ \\Let $S_1, \dots, S_n$ be sequences, $G=(V,E)$ be the complete alignment graphand $w$ be weight function. Complete maximum-weight trace problem is to findtrace $T \subset E$ with maximal weight (under $w$). Maximum-weight traceproblem is defined analogously for an (incomplete) alignment graph $G=(V,E)$for $S_1, \dots S_n$.[/latex]
Maximum-Weight Trace: Non-Trace Subsets 	[latex]\begin{itemize}    \item problem: not every edge subset is a trace (some edge subsets can notbe realized by any alignment)    \item example: crossing of two edges:\end{itemize}[/latex]TODO: INSERT IMAGE WITH TEXT BELOW FROM SLIDE 6 SLIDESET 06
Theorem: Kececioglu (Maximum-Weight Trace-Extended alignment graphs)  	[latex]Let $S_1, \dots, S_n$ sequences, $G=(V, E, \prec$ extended alignment graph.Then subset $T \subseteq E$ is trace iff $\lhd^*$ is strict partial order onconnected components of $G'=(V,T)$.[/latex]
Extended Alignment Graphs: Partial Orders on Nodes 	[latex]\begin{itemize}    \item Motivation: prevent non-trace edge subsets (e.g. crossing edges)    \item Idea: extend alignment graphs by strict partial orders    \item extended alignment graph:\begin{equation*}G=(V, E, \prec)\end{equation*}where $G'=(V, E)$ is alignment graph for $S_1, \dots, S_n$ and $\prec$ definedby:\begin{equation*}s_{ij} \prec s_{i j+1} \ \forall i \in [1,n], j \in[1, n_i]\end{equation*}\item Let $\prec^*$ be the transitive closure of $\prec$ - then $\prec^*$ is apartial order of the nodes $V$.        \end{itemize}[/latex]
 Extended Alignment Graphs: Extend Partial Orders From Nodes to ConnectedComponents 	[latex]\begin{enumerate}    \item given: extended alignment graph with partial order $\prec$(transitive closure: $\prec^*$) on nodes (see other card)    \item A connected component of graph $G=(V,E)$ is $\subseteq$-maimal set$V' \subseteq V$ st. for all vertices $v, v' \in V'$ there is path of edges in$E$ connecting $v, v'$    \item For any two subsets $X,Y \subseteq V$, we define:\begin{equation*}X \lhd Y \text{ iff } \exists v \in X \exists v' \in Y: v \prec v'\end{equation*}    \item Let $\lhd^*$ be the transitive closure of $\lhd$    \item Hence:\begin{equation*}X \lhd^* Y \text{ iff } \exists v \in X, \exists v' \in Y: v \prec^* v'\end{equation*}\end{enumerate}[/latex]
